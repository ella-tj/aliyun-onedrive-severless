(function(e){function t(t){for(var r,c,i=t[0],u=t[1],s=t[2],l=0,d=[];l<i.length;l++)c=i[l],Object.prototype.hasOwnProperty.call(o,c)&&o[c]&&d.push(o[c][0]),o[c]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);f&&f(t);while(d.length)d.shift()();return a.push.apply(a,s||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,i=1;i<n.length;i++){var u=n[i];0!==o[u]&&(r=!1)}r&&(a.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},o={app:0},a=[];function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=t,i=i.slice();for(var s=0;s<i.length;s++)t(i[s]);var f=u;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"64be":function(e,t,n){"use strict";n("c894")},c894:function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d");var r=n("53ca"),o=(n("96cf"),n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("9ab4")),a=n("7a23"),c=Object(a["e"])("p",null,null,-1);function i(e,t,n,r,o,i){return Object(a["g"])(),Object(a["d"])(a["a"],null,[Object(a["e"])("button",{onClick:t[1]||(t[1]=function(){return e.startAuth.apply(e,arguments)})},"get token"),c,Object(a["m"])(Object(a["e"])("textarea",{cols:"30",rows:"10","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.refresh_token=t}),readonly:""},null,512),[[a["k"],e.refresh_token]])],64)}var u=n("d4ec"),s=n("bee2"),f=n("262e"),l=n("2caf"),d=n("ce1f"),p=(n("99af"),n("4160"),n("a15b"),n("d81d"),n("4fad"),n("159b"),n("3835")),h="f20605cf-927f-4f57-bfef-3b1738ed0871",b="rVsI96_DUWbz3V15M2CP2IMv3-2c_~.5.X",v="".concat(location.origin).concat(location.pathname),m=["files.read.all","offline_access"].join(" ");function g(){var e="code",t="fragment",n=new URL("https://login.microsoftonline.com/common/oauth2/v2.0/authorize"),r={client_id:h,redirect_uri:v,response_type:e,scope:m,response_mode:t};return Object.entries(r).forEach((function(e){var t=Object(p["a"])(e,2),r=t[0],o=t[1];n.searchParams.set(r,o)})),n.href}function j(e){return Object(o["a"])(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new FormData,r={client_id:h,redirect_uri:v,client_secret:b,code:e,grant_type:"authorization_code"},Object.entries(r).forEach((function(e){var t=Object(p["a"])(e,2),r=t[0],o=t[1];n.set(r,o)})),t.next=5,fetch("https://login-microsoftonline-com.lisonge.workers.dev/common/oauth2/v2.0/token",{method:"POST",body:n});case 5:return o=t.sent,t.next=8,o.json();case 8:return a=t.sent,a.mark="6807365a",t.abrupt("return",a);case 11:case"end":return t.stop()}}),t)})))}function O(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=g();if(e){var n={width:screen.availWidth/4,height:screen.availHeight/1.5,left:0,top:0};n.left=screen.availWidth/2-n.width/2,n.top=screen.availHeight/2-n.height/2,window.open(t,"",Object.entries(n).map((function(e){var t=Object(p["a"])(e,2),n=t[0],r=t[1];return"".concat(n,"=").concat(r)})).join(","))}else window.open(t)}var w=n("5502"),_=Object(w["a"])({state:{auth:{token_type:"",scope:"",expires_in:3600,ext_expires_in:3600,access_token:"",refresh_token:""}},mutations:{assignAuth:function(e,t){Object.assign(e.auth,t.auth)}},actions:{},modules:{}}),y=_.state,k=_,x=function(e){Object(f["a"])(n,e);var t=Object(l["a"])(n);function n(){var e;return Object(u["a"])(this,n),e=t.apply(this,arguments),e.refresh_token=Object(a["b"])((function(){return y.auth.refresh_token})),e}return Object(s["a"])(n,[{key:"startAuth",value:function(){return Object(o["a"])(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:O(!0);case 1:case"end":return e.stop()}}),e)})))}}]),n}(d["b"]);x=Object(o["b"])([Object(d["a"])({components:{}})],x);var P=x;n("64be");P.render=i;var R=P,S=new URLSearchParams(location.hash.substring(1)),T=3,M=document.querySelector("#app");if(S.has("error"))setTimeout(window.close,1e3*T),setInterval((function(){M.innerText="获取授权令牌失败\n".concat(T,"秒后自动关闭窗口"),T-=1}),1e3);else if(S.has("code")){var A=S.get("code");M.innerText="获取授权令牌中";var I=function(){return Object(o["a"])(void 0,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,j(A);case 2:t=e.sent,window.opener.postMessage(t,location.origin),setTimeout(window.close,1e3*T),setInterval((function(){M.innerText="获取授权令牌成功\n".concat(T,"秒后自动关闭窗口"),T-=1}),1e3);case 6:case"end":return e.stop()}}),e)})))};I()}else Object(a["c"])(R).use(k).mount("#app"),addEventListener("message",(function(e){if(e.origin==location.origin&&"object"==Object(r["a"])(e.data)){var t=e.data;console.log(t),"6807365a"==t.mark&&k.commit("assignAuth",{auth:t})}}))}});
//# sourceMappingURL=app.c5ce8c52.js.map